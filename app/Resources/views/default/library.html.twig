{% extends 'base.html.twig' %}
{% block body %}
    <div id="library">

      <section>

        <article id="categories">
          <div class="title">
            Filtrer
          </div>
          <div class="options-tri" ng-cloak>
            <div id='library-categories' class="options-container">
              <div class="type">
                Catégories
              </div>
              <div class="list">
                  <div class="checkbox" ng-repeat='c in Library.categories.elements' ng-cloak>
                      <input id='{(c.idCategory)}' ng-model='Library.categories.values[c.idCategory]' type="checkbox"/>
                      <label for="{(c.idCategory)}"></label>
                      <span>{(c.name)}</span>
                  </div>
              </div>
              <pre>{(Library.categories.values | json)}</pre>
              <pre>No one selected :{(Library.categories.noSelected() | json)}</pre>
            </div>
          </div>
        </article>

        <article id="book-library">
          <div class="title">
            <div class="group">
              <span>Résultats</span>
              <select class="" name="">
                <option value="">20 par page</option>
              </select>
            </div>
            <div class="group">
              <span>Trier par</span>
              <select class="" name="">
                <option value="">Genre</option>
                <option value="">Prix</option>
              </select>
            </div>
            <div class="group">
              <div class="bouton openPopupWindow" target='addBook-window' popup='addBook' design='blanc'>
                <img src="/assets/add.svg" alt="">Ajouter un livre
              </div>
            </div>
          </div>
          <div class="library-list">
            <ul class="books-list">
              <li ng-repeat='book in Library.books.elements' class='book-wrapper' ng-cloak
                  ng-click='BookShow.show(book)'>
                  <div class="cover" style='background-image: url("{(book.img)}")'></div>
                  <div class="name info-book">{(book.name)}</div>
                  <div class="author info-book">{(book.author)}</div>
                  <rating-form vg-init='3.7' vg-editable='false'>
                  </rating-form>
              </li>
            </ul>
          </div>
        </article>

      </section>

    </div>



<!-- Popups -->

    <div id='addBook-window' class="popup-window">
      <div class="window">
        <form name='AddBookFormX' ng-submit='AddBookForm.submit()'>

          <div class="header">
              Ajouter un livre

              <img src="/assets/quit.svg" class='closePopupWindow' alt="">
          </div>
          <div class="content" style='width: 900px'>
              <div class="form-section" >
                <div class="legend">
                  La recherche par titre va completer automatiquement les informations du livre
                </div>
                <search-form vg-model='AddBookForm.values.search'
                            vg-data='AddBookForm.elements.search'
                            vg-source='{(AddBookForm.elements.search.source)}'
                            on-select-result='selectResult(result)'>
                </search-form>
                <text-form vg-model='AddBookForm.values.author'
                            vg-type='AddBookForm.elements.author.type'
                            vg-name='AddBookForm.elements.author.name'
                            vg-placeholder='AddBookForm.elements.author.placeholder'
                            vg-validator='AddBookForm.elements.author.validator'
                            vg-errors='AddBookForm.elements.author.errors'
                            vg-required='AddBookForm.elements.author.required'>
                </text-form>
                <text-form vg-model='AddBookForm.values.illustration'
                            vg-type='AddBookForm.elements.illustration.type'
                            vg-name='AddBookForm.elements.illustration.name'
                            vg-placeholder='AddBookForm.elements.illustration.placeholder'
                            vg-validator='AddBookForm.elements.illustration.validator'
                            vg-errors='AddBookForm.elements.illustration.errors'
                            vg-required='AddBookForm.elements.illustration.required'>
                </text-form>
                <area-form vg-model='AddBookForm.values.description'
                            vg-type='AddBookForm.elements.description.type'
                            vg-name='AddBookForm.elements.description.name'
                            vg-placeholder='AddBookForm.elements.description.placeholder'
                            vg-validator='AddBookForm.elements.description.validator'
                            vg-errors='AddBookForm.elements.description.errors'
                            vg-required='AddBookForm.elements.description.required'>
                </area-form>
                <text-form vg-model='AddBookForm.values.date'
                            vg-type='AddBookForm.elements.date.type'
                            vg-name='AddBookForm.elements.date.name'
                            vg-placeholder='AddBookForm.elements.date.placeholder'
                            vg-validator='AddBookForm.elements.date.validator'
                            vg-errors='AddBookForm.elements.date.errors'
                            vg-required='AddBookForm.elements.date.required'>
                </text-form>
                <text-form vg-model='AddBookForm.values.pages'
                            vg-type='AddBookForm.elements.pages.type'
                            vg-name='AddBookForm.elements.pages.name'
                            vg-placeholder='AddBookForm.elements.pages.placeholder'
                            vg-validator='AddBookForm.elements.pages.validator'
                            vg-errors='AddBookForm.elements.pages.errors'
                            vg-required='AddBookForm.elements.pages.required'>
                </text-form>
                <token-form vg-model='AddBookForm.values.categories'
                            vg-data='AddBookForm.elements.categories'>
                </token-form>
                <div class='legend'>Veuillez donner une note pour ce livre</div>
                <rating-form vg-model='AddBookForm.values.rating'
                              vg-required='AddBookForm.elements.rating.required'
                              vg-name='AddBookForm.elements.rating.name'
                              vg-editable='AddBookForm.elements.rating.editable'
                              vg-init='AddBookForm.elements.rating.init'>
                </rating-form>
                <pre>{(AddBookForm.values | json)}</pre>
              </div><!--
            --><div class="form-section" color>
                  <div class="book-form-preview" >
                    <div class="book-blur" style='background-image: url({(AddBookForm.values.illustration)})'></div>
                    <div class="input-form-wrap">
                      <div class="cover" ng-show='!coverLoaded && coverSearching'>
                        <div class="loading-spinner"></div>
                      </div>
                      <div class="cover" ng-show='!coverLoaded && !coverSearching' style='background-image: url("/assets/no_thumbnail.jpg")'>
                      </div>
                      <div class="cover" ng-show='coverLoaded && !coverSearching' style='background-image: url({(AddBookForm.values.illustration.length > 10?AddBookForm.values.illustration:"/assets/no_thumbnail.jpg")})'>
                      </div>
                    </div>
                    <div class="input-form-wrap">
                      <div class="title-book">
                        {(AddBookForm.values.search? (AddBookForm.values.search | cap) : 'Titre du livre')}
                      </div>
                    </div>
                  </div>
                  <div class="infos-book">
                    <div class="infos-header">
                      <div class="i-h-info">
                        <div class="i-h-img">
                          <img src="/assets/euro.svg">
                        </div>
                        <div class='i-h-text'>{(AddBookForm.values.price || '-')}</div>
                      </div>
                      <div class="i-h-info">
                        <div class="i-h-img">
                          <img src="/assets/book.svg">
                        </div>
                        <div class='i-h-text'>{(AddBookForm.values.pages || '-')} <span ng-if='AddBookForm.values.pages'>pages</span></div>
                      </div>
                      <div class="i-h-info">
                        <div class="i-h-img">
                          <img src="/assets/date.svg">
                        </div>
                        <div class='i-h-text'>{(AddBookForm.values.date || '-')}</div>
                      </div>
                    </div>
                    <div class="info-book">
                      <div class="i-b-title">Autheur</div>
                      <div class="i-b-content">{(AddBookForm.values.author || '-')}</div>
                    </div>
                    <div class="info-book">
                      <div class="i-b-title">Description</div>
                      <div class="i-b-content">{(AddBookForm.values.description || '-')}</div>
                    </div>

                    <div class="info-book">
                      <div class="i-b-title">Lien d'achat</div>
                      <a class="i-b-content" ng-class='{link: AddBookForm.values.buyLink}' target='_blank'
                      ng-href='{(AddBookForm.values.buyLink || "#")}'>{(AddBookForm.values.buyLink?'Lien Play Store':'-')}</a>
                    </div>

                  </div>
              </div>
          </div>
          <div class="footer">
            <div class="bouton" design='blanc'>Annuler</div>
            <div class="bouton" design='blanc' ng-click='AddBookForm.reset()'>Vider les champs</div>
            <button class="bouton" type='submit' design='green'
            ng-disabled='AddBookFormX.$invalid'>Ajouter un livre</button>

          </div>

        </form>
      </div>
    </div>


    <div id='bookshow-window' class="popup-window">
      <div class="window">
          <div class="header">
              Aperçu d'un livre

              <a href="#"><img src="/assets/link.svg" class='externalLink' alt="Ouvrir le lien de la page"></a>
              <img src="/assets/quit.svg" class='closePopupWindow' alt="Fermer la fenêtre">
          </div>
          <div class="content">
            <div class="book-form-preview">
              <div class="book-blur" style='background-image: url({(BookShow.book.img)})'></div>
              <div class="input-form-wrap">
                <div class="cover" style='background-image: url({(BookShow.book.img.length > 10?BookShow.book.img:"/assets/no_thumbnail.jpg")})'>
                </div>
              </div>
              <div class="input-form-wrap">
                <div class="title-book">
                  {(BookShow.book.name? (BookShow.book.name | cap) : 'Titre du livre')}
                </div>
              </div>
            </div>
            <div class="infos-book">
              <div class="infos-header">
                <div class="i-h-info">
                  <div class="i-h-img">
                    <img src="/assets/euro.svg">
                  </div>
                  <div class='i-h-text'>{(BookShow.book.price || '-')}</div>
                </div>
                <div class="i-h-info">
                  <div class="i-h-img">
                    <img src="/assets/book.svg">
                  </div>
                  <div class='i-h-text'>{(BookShow.book.numberPage || '-')} <span ng-if='BookShow.book.numberPage'>pages</span></div>
                </div>
                <div class="i-h-info">
                  <div class="i-h-img">
                    <img src="/assets/date.svg">
                  </div>
                  <div class='i-h-text'>{(BookShow.book.releaseDate.timestamp | date:'dd-MM-y' || '-')}</div>
                </div>
              </div>
              <div class="info-book">
                <div class="i-b-title">Autheur</div>
                <div class="i-b-content">{(BookShow.book.author || '-')}</div>
              </div>
              <div class="info-book">
                <div class="i-b-title">Description</div>
                <div class="i-b-content">{(BookShow.book.description || '-')}</div>
              </div>
              <div class="info-book">
                <div class="i-b-title">Lien d'achat</div>
                <a class="i-b-content" ng-class='{link: BookShow.book}' target='_blank'
                ng-href='{(BookShow.book.buyLink || "#")}'>{(BookShow.book.buyLink?'Lien Play Store':'-')}</a>
              </div>

            </div>
          </div>
          <div class="footer">
            <div class="bouton" design='blanc'>Fermer</div>
            <div class="bouton" design='green'>Créer un salon</div>

          </div>
      </div>
    </div>

{% endblock %}
